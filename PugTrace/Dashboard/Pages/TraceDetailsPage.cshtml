@* Generator: Template TypeVisibility: Internal GeneratePrettyNames: True *@
@using System
@using System.Linq
@using PugTrace.Dashboard
@using PugTrace.Dashboard.Pages
@using Newtonsoft.Json
@using Newtonsoft.Json.Linq
@inherits RazorPage
@{
    Layout = new LayoutPage();
}
@using (var connection = Storage.GetConnection())
{
    var trace = connection.GetTraceDetail(TraceId);
    JArray json = null;

    if (!string.IsNullOrEmpty(trace.Data))
    {
        json = JArray.Parse(trace.Data);
    }

    <dl class="dl-horizontal">
        <dt>Application</dt>
        <dd>@trace.ApplicationName</dd>
        <dt>Source</dt>
        <dd>@trace.Source</dd>
        <dt>Id</dt>
        <dd>@trace.Id</dd>
        <dt>Event Type</dt>
        <dd>@trace.EventType</dd>
        <dt>Timestamp</dt>
        <dd>@trace.UtcDateTime.ToString("f")</dd>
        <dt>Machine</dt>
        <dd>@trace.MachineName</dd>
        @if (!string.IsNullOrEmpty(trace.Message))
        {
            <dt>Message</dt>
            <dd>@trace.Message</dd>
        }
    </dl>

    if (json != null)
    {
        foreach (var property in json)
        {
            if (property.Type == JTokenType.Object)
            {
                var obj = property.Value<JObject>();

                @Html.DataObject(obj)
            }
        }
    }
}
